# SConstruct
import os

def _converter(val):
    if val == 'none':
      val = []
    else:
      val = val.split(' ')
    return val

def RawListVariable(key, help, default):
    return (key, '%s' % (help), default, None, lambda val: _converter(val))

opts = Variables()
opts.AddVariables(
    RawListVariable("FOOBAR", "Testing", None),
    RawListVariable("BAZ", "Testing", None),
)

env = Environment(variables=opts)

conan = SConscript("SConscript_conan")
if not conan:
    print("File `SConscript_conan` is missing.")
    print("It should be generated by running `conan install`.")
    sys.exit(1)

flags = conan["conan"]
env.MergeFlags(flags)

print("CC is: {}".format(env.subst('$CC')))

test_package = env.Program(["test_package.c"])
